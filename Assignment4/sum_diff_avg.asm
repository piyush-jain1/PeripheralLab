CPU "8085.tbl"
HOF "int8"
		RDKBD: EQU 03BAH
		UPDDT: EQU 044CH
		UPDAD: EQU 0440H
		GTHEX: EQU 030EH
		HXDSP: EQU 034FH
		GETCH: EQU 0C12H

ORG 9000H

START:	NOP
		MVI A,8BH	
		OUT 43H
		MVI A,80H	
		OUT 03H
		CALL RDKBD
		CPI 00H
		JZ ADD
		CPI 01H
		JZ SUB
		CPI 02H
		JZ AVG
		
ADD:	MVI D,00H
		MVI E,00H
		CALL CONVERT
		STA 9300H
		MVI D,04H
		CALL CONVERT
		STA 9301H

		LDA 9300H
		MOV B,A
		LDA 9301H
		ADD B
		STA 9302H

		OUT 00H
		OUT 01H

		CALL DISPLAY
		CALL DELAY
		JMP ADD

SUB:	MVI D,00H
		MVI E,00H
		CALL CONVERT
		STA 9300H
		MVI D,04H
		CALL CONVERT
		STA 9301H

		LDA 9300H
		MOV B,A
		LDA 9301H
		JMP AB

DISP:	OUT 00H
		OUT 01H
		CALL DISPLAY
		CALL DELAY
		JMP SUB

AB:		NOP
		SUB B
		STA 9308H
		JMP DISP

AVG:	MVI A,14H
		STA 9300H
		MVI D,00H
		MVI E,00H

REL:	CALL RDKBD
		MVI D,00H
		CALL CONVERT
		STA 9301H
		LDA 9300H
		MOV B,A
		LDA 9301H
		SUB B
		STA 9302H
		JMP DIVD
		
THIS:	LDA 9300H
		ADD B
		STA 9300H

		OUT 00H
		OUT 01H
		
		CALL DISPLAY
		CALL DELAY






		JMP REL

DIVD: 	LDA 9302H
		MVI B,00H
		MVI D,14H
LS:		CMP D
		JC 	THIS
		SUB D
		INR B
		JMP LS

CONVERT:MVI A,00H
		ORA D
		OUT 40H

		MVI A,20H
		ORA D
		OUT 40H
		NOP 
		NOP
		MVI A,00H
		ORA D
		OUT 40H
WAIT1:	IN 42H
		ANI 01H
		JNZ WAIT1
WAIT2:	IN 42H
		ANI 01H
		JZ WAIT2

		MVI A,40H
		ORA D
		OUT 40H
		NOP
		IN 41H
		PUSH PSW
		MVI A,00H
		ORA D
		OUT 40H
		POP PSW
		RET

DISPLAY:PUSH PSW
		IN 50H
		ANI 08H
		JNZ DISPKBD	
		RET	

DISPKBD:MOV A,E
		STA 8FEFH

		XRA A
		STA 8FF0H
		POP PSW
		STA 8FF1H
		PUSH D
		MVI B,00H
		CALL 0440H
		MVI B,00H
		CALL 044CH
		POP D
		RET

DELAY:	MVI B,01H
OUTLOOP:LXI D, 0FH
INLOOP:
		DCX D
		MOV A,D
		ORA E
		JNZ INLOOP
		DCR B
		JNZ OUTLOOP
		RET