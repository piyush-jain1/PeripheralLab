CPU "8085.tbl"
HOF "int8"
		RDKBD: EQU 03BAH
		UPDDT: EQU 044CH
		UPDAD: EQU 0440H
		GTHEX: EQU 030EH
		HXDSP: EQU 034FH
		GETCH: EQU 0C12H

ORG 9000H

START:	MVI A,80H
		OUT 03H
		MVI A,8BH
		OUT 43H
		MVI A,88H
		STA 8001H
		
LOOP:	CALL SUB
		CALL DELAY
		LDA 8001H
		RRC
		STA 8001H
		OUT 00H
		JMP LOOP 

SUB:	MVI D,0DH
		CALL CONVERT
		STA 9300H
		MOV C,A
		MVI A,0FFH
		SUB C
		STA 9300H
		RET
		
CONVERT:NOP
		MVI A,00H
		ORA D
		OUT 40H
		MVI A,20H
		ORA D
		OUT 40H
		NOP 
		NOP
		MVI A,00H
		ORA D
		OUT 40H

WAIT1:	IN 42H
		ANI 01H
		JNZ WAIT1

WAIT2:	IN 42H
		ANI 01H
		JZ WAIT2
		MVI A,40H
		ORA D
		OUT 40H
		NOP
		IN 41H
		PUSH PSW
		MVI A,00H
		ORA D
		OUT 40H
		POP PSW
		RET


DELAY:	NOP
		PUSH PSW
		LXI H,0001H

DELAY20:NOP
		LXI D, 0FFFFH
		LDA 9300H
		MOV D,A

DELAY10:DCX D
		MOV A,D
		ORA E
		JNZ DELAY10
		DCX H
		MOV A,H
		ORA L
		JNZ DELAY20
		POP PSW
		RET

